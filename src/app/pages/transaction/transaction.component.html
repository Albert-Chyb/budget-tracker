<form
	#transactionForm="ngForm"
	(ngSubmit)="isInEditState ? update() : create()"
>
	<mat-form-field>
		<mat-label>Kwota</mat-label>
		<input
			matInput
			type="text"
			name="amount"
			required
			[(ngModel)]="formValue.amount"
			#name="ngModel"
			money-amount-validator
		/>
		<mat-icon matPrefix>paid</mat-icon>

		<mat-error *ngIf="name.hasError('required')">Kwota jest wymagana</mat-error>
		<mat-error *ngIf="name.hasError('invalidMoneyFormat')">
			Podaj <strong>poprawnie sformatowaną</strong> kwotę
		</mat-error>
	</mat-form-field>

	<mat-form-field>
		<mat-label>Data</mat-label>
		<input
			matInput
			type="text"
			name="date"
			[matDatepicker]="datepicker"
			required
			[(ngModel)]="formValue.date"
			#date="ngModel"
		/>
		<mat-icon matPrefix>today</mat-icon>

		<mat-datepicker-toggle matSuffix [for]="datepicker">
			<mat-icon matDatepickerToggleIcon>expand_more</mat-icon>
		</mat-datepicker-toggle>
		<mat-datepicker #datepicker></mat-datepicker>

		<mat-error *ngIf="date.hasError('required')">
			Data jest <strong>wymagana</strong> w formacie dd.mm.yyyy
		</mat-error>
	</mat-form-field>

	<mat-form-field>
		<mat-label>Kategoria</mat-label>
		<mat-select
			name="category"
			required
			[(ngModel)]="formValue.category"
			#category="ngModel"
		>
			<mat-option value="1">Codzienne zakupy</mat-option>
			<mat-option value="2">Paliwo</mat-option>
			<mat-option value="3">Imprezy</mat-option>
		</mat-select>
		<mat-icon matPrefix>category</mat-icon>

		<mat-error *ngIf="category.hasError('required')">
			Kategoria jest wymagana
		</mat-error>
	</mat-form-field>

	<mat-form-field>
		<mat-label>Portfel</mat-label>
		<mat-select
			name="wallet"
			required
			[(ngModel)]="formValue.wallet"
			#wallet="ngModel"
		>
			<mat-option value="1">Konto oszczędnościowe</mat-option>
			<mat-option value="2">Konto bankowe</mat-option>
			<mat-option value="3">Portfel</mat-option>
		</mat-select>
		<mat-icon matPrefix>account_balance_wallet</mat-icon>

		<mat-error *ngIf="wallet.hasError('required')">
			Portfel jest wymagany
		</mat-error>
	</mat-form-field>

	<mat-form-field>
		<mat-label>Opis</mat-label>
		<input
			matInput
			type="text"
			name="description"
			minlength="3"
			maxlength="128"
			[(ngModel)]="formValue.description"
			#description="ngModel"
		/>
		<mat-icon matPrefix>description</mat-icon>

		<mat-error *ngIf="description.hasError('minlength')">
			Opis <strong>musi posiadać</strong> przynjamniej
			{{ description.getError('minlength').requiredLength }} znaków
		</mat-error>
		<mat-error *ngIf="description.hasError('maxlength')">
			Opis <strong>nie może posiadać</strong> więcej niż
			{{ description.getError('maxlength').requiredLength }} znaków
		</mat-error>
	</mat-form-field>

	<div class="form-actions">
		<button
			type="submit"
			mat-flat-button
			color="accent"
			[disabled]="transactionForm.invalid"
		>
			{{ isInEditState ? 'Zapisz' : 'Dodaj' }}
		</button>

		<button
			type="reset"
			mat-flat-button
			color="warn"
			*ngIf="!isInEditState; else deleteTransactionButton"
		>
			Wyczyść
		</button>
	</div>
</form>

<ng-template #deleteTransactionButton>
	<button type="button" mat-flat-button color="warn" (click)="delete()">
		Usuń
	</button>
</ng-template>

{{ formValue | json }}
